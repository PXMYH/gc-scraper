<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Green Card Processing Time</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .workflow-time {
            font-size: 18px;
            color: #0366d6;
        }
        .last-updated {
            font-size: 12px;
            color: #666;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>US Green Card Processing Time</h1>

    <!-- Add the "i485" section above the graph -->
    <section>
        <h2>i485</h2>
        <!-- Embed the image within the HTML using the <img> tag -->
        <img src="data/visa_bulletin_plot.png" alt="Visa Bulletin Plot" width="400">
    </section>

    <!-- Add the "PERM" section before the displayed time -->
    <section>
        <h2>PERM</h2>
        <p class="workflow-time" id="time"></p>
    </section>

    <!-- Last updated timestamp -->
    <p class="last-updated">Last updated: <span id="timestamp">Loading...</span></p>

    <script>
        // Function to fetch and display time from perm_time.txt
        async function displayTime() {
            try {
                const response = await fetch('data/perm_time.txt');
                const text = await response.text();
                const time = text.trim();
                if (time) {
                    document.getElementById('time').textContent = time;
                }
            } catch (error) {
                console.error('Error fetching and displaying time:', error);
            }
        }

        // Function to fetch and display last updated timestamp
        async function displayTimestamp() {
            try {
                const response = await fetch('data/last_updated.txt');
                const text = await response.text();
                const timestamp = text.trim();
                if (timestamp) {
                    document.getElementById('timestamp').textContent = timestamp;
                }
            } catch (error) {
                document.getElementById('timestamp').textContent = 'Unknown';
            }
        }

        // Call the functions to display data
        displayTime();
        displayTimestamp();
    </script>
</body>
</html>
